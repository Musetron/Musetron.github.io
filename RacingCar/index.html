<!DOCTYPE html>  <html lang="de">    
<head>    
<meta charset="UTF-8">    
<title>Racing Car</title>    
<style>    
    html, body {    
        margin: 0;    
        padding: 0;    
        width: 100%;    
        height: 100%;    
        background-color: #121212;    
        color: #fff;    
        font-family: Arial, sans-serif;    
        overflow: hidden;    
        display: flex;    
        flex-direction: column;    
        align-items: center;    
        justify-content: center;    
    }  h1 {    
    font-size: 2em;    
    color: #bb86fc;    
    margin: 0;    
    text-align: center;    
}    
  
input[type="file"] {    
    margin: 10px 0 30px 0;    
    padding: 10px 20px;    
    border-radius: 8px;    
    border: none;    
    background-color: #1e1e1e;    
    color: #fff;    
    font-size: 16px;    
    cursor: pointer;    
}    
  
.pedal-container {    
    display: flex;    
    justify-content: space-between;    
    width: 400px;    
    margin-top: 40px;    
}    
  
.slider-container {    
    display: flex;    
    flex-direction: column;    
    align-items: center;    
}    
  
input[type="range"].vertical {    
    -webkit-appearance: slider-vertical;    
    width: 40px;    
    height: 150px;    
    writing-mode: bt-lr;    
    background: #1e1e1e;    
    border-radius: 10px;    
    accent-color: #bb86fc;    
    cursor: grab;    
    margin-bottom: 10px;    
}    
  
button {    
    background-color: #bb86fc;    
    color: #121212;    
    padding: 10px 20px;    
    border-radius: 8px;    
    border: none;    
    font-weight: bold;    
    cursor: pointer;    
    transition: 0.2s;    
}    
  
button:hover {    
    background-color: #9a67ea;    
}    
  
.tacho-container {    
    width: 400px;    
    height: 200px;    
    position: relative;    
    margin-top: 20px;    
}    
  
.tacho-bg {    
    position: absolute;    
    bottom: 0;    
    left: 50%;    
    transform: translateX(-50%);    
    width: 100%;    
    height: auto;    
    z-index: 1;    
}    
  
.tacho {    
    position: absolute;    
    bottom: 0;    
    left: 0;    
    width: 100%;    
    height: 100%;    
    z-index: 2;    
    pointer-events: none;    
}  
  
</style>    
</head>    
<body>    
<h1>Racing Car</h1>    
<input type="file" id="fileInput" accept=".wav">  <div class="tacho-container">    
    <img src="https://i.ibb.co/7dc4fnhT/speedometer-PNG36.png" alt="Tacho" class="tacho-bg"/>    
    <svg class="tacho" viewBox="0 0 400 200">    
        <!-- Realistische Tachonadel -->    
        <line id="needle" x1="200" y1="200" x2="200" y2="40" stroke="#ff0000" stroke-width="6" stroke-linecap="round"/>    
        <circle cx="200" cy="200" r="8" fill="#ff0000"/>    
    </svg>    
</div>  <div class="pedal-container">    
    <div class="slider-container">    
        <input type="range" id="gasSlider" class="vertical" min="0.01" max="0.1" step="0.001" value="0.03">    
        <button id="gasBtn">GAS</button>    
    </div>    
    <div class="slider-container">    
        <input type="range" id="brakeSlider" class="vertical" min="0.01" max="0.1" step="0.001" value="0.02">    
        <button id="brakeBtn">BREMSE</button>    
    </div>    
</div>  <script>    
let audioContext;    
let bufferSource;    
let audioBuffer;    
let gainNode;    
    
const fileInput = document.getElementById('fileInput');    
const gasBtn = document.getElementById('gasBtn');    
const brakeBtn = document.getElementById('brakeBtn');    
const gasSlider = document.getElementById('gasSlider');    
const brakeSlider = document.getElementById('brakeSlider');    
const needle = document.getElementById('needle');    
    
const idleVolume = 0.2;    
let currentVolume = idleVolume;    
let gasPressed = false;    
let brakePressed = false;    
    
const idlePitch = 1.0;    
const maxPitch = 2.0;    
let currentPitch = idlePitch;    
    
fileInput.addEventListener('change', async () => {    
    const file = fileInput.files[0];    
    if (!file || file.type !== 'audio/wav') {    
        alert("Bitte wähle eine gültige WAV-Datei aus.");    
        return;    
    }    
    if (!audioContext) audioContext = new (window.AudioContext || window.webkitAudioContext)();    
    const arrayBuffer = await file.arrayBuffer();    
    audioBuffer = await audioContext.decodeAudioData(arrayBuffer);    
    playBuffer();    
});    
    
function playBuffer() {    
    if (bufferSource) bufferSource.stop();    
    bufferSource = audioContext.createBufferSource();    
    bufferSource.buffer = audioBuffer;    
    bufferSource.loop = true;    
    
    gainNode = audioContext.createGain();    
    gainNode.gain.value = idleVolume;    
    
    bufferSource.connect(gainNode).connect(audioContext.destination);    
    bufferSource.start();    
}    
    
// Gas Button Events    
gasBtn.addEventListener('mousedown', () => gasPressed = true);    
gasBtn.addEventListener('mouseup', () => gasPressed = false);    
gasBtn.addEventListener('mouseleave', () => gasPressed = false);    
gasBtn.addEventListener('touchstart', e => { e.preventDefault(); gasPressed = true; });    
gasBtn.addEventListener('touchend', e => { e.preventDefault(); gasPressed = false; });    
    
// Bremse Button Events    
brakeBtn.addEventListener('mousedown', () => brakePressed = true);    
brakeBtn.addEventListener('mouseup', () => brakePressed = false);    
brakeBtn.addEventListener('mouseleave', () => brakePressed = false);    
brakeBtn.addEventListener('touchstart', e => { e.preventDefault(); brakePressed = true; });    
brakeBtn.addEventListener('touchend', e => { e.preventDefault(); brakePressed = false; });    
    
// Animation für Audio & Tachonadel    
function animate() {    
    const gasStrength = parseFloat(gasSlider.value);    
    const brakeStrength = parseFloat(brakeSlider.value);    
    
    // Lautstärke anpassen    
    if (gasPressed) {    
        currentVolume += gasStrength;    
        if (currentVolume > 1) currentVolume = 1;    
    } else if (brakePressed) {    
        currentVolume += (idleVolume - currentVolume) * 0.05;    
    } else {    
        currentVolume += (idleVolume - currentVolume) * 0.02;    
    }    
    
    // Pitch anpassen    
    if (gasPressed) {    
        currentPitch += gasStrength * 0.05 * (maxPitch - currentPitch);    
        if (currentPitch > maxPitch) currentPitch = maxPitch;    
    } else if (brakePressed) {    
        currentPitch += (idlePitch - currentPitch) * 0.05;    
    } else {    
        currentPitch += (idlePitch - currentPitch) * 0.01;    
    }    
    
    if (gainNode) gainNode.gain.value = currentVolume;    
    if (bufferSource) bufferSource.playbackRate.value = currentPitch;    
    
    // Tachonadel: -90° bis +90° je nach Pitch    
    const tachoValue = (currentPitch - idlePitch) / (maxPitch - idlePitch);    
    const angle = -90 + tachoValue * 180;    
    needle.setAttribute('transform', `rotate(${angle} 200 200)`);    
    
    requestAnimationFrame(animate);    
}    
    
animate();    
</script>  </body>    
</html>  
