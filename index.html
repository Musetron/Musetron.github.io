<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Live-Mikrofon-Feed</title>
<style>
  body { margin: 0; background: black; }
  canvas { display: block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

navigator.mediaDevices.getUserMedia({ audio: true })
.then(stream => {
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const source = audioCtx.createMediaStreamSource(stream);
  const analyser = audioCtx.createAnalyser();

  source.connect(analyser);
  analyser.fftSize = 1024;

  const bufferLength = analyser.frequencyBinCount;
  const dataArray = new Uint8Array(bufferLength);

  function draw() {
    requestAnimationFrame(draw);

    analyser.getByteTimeDomainData(dataArray);

    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    const squareSize = Math.floor(Math.sqrt(bufferLength));
    let idx = 0;

    for (let y = 0; y < squareSize; y++) {
      for (let x = 0; x < squareSize; x++) {
        if (idx >= bufferLength) break;
        const brightness = dataArray[idx] / 255; // 0-1
        const color = Math.floor(brightness * 255);
        ctx.fillStyle = `rgb(${color},${color},${color})`;
        ctx.fillRect(x * 4, y * 4, 4, 4); // Pixelgröße 4x4
        idx++;
      }
    }
  }

  draw();
})
.catch(err => {
  console.error("Mikrofon Zugriff verweigert:", err);
});
</script>
</body>
</html>
