<!DOCTYPE html>  
<html lang="de">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1.0" />  
<title>BroChatter</title>  
  
<style>  
    body {  
        margin:0; padding:0;  
        font-family:Arial;  
        background:white;  
        display:flex;  
        justify-content:center;  
    }  
  
    #app {  
        width:380px;  
        height:100vh;  
        background:white;  
        display:flex;  
        flex-direction:column;  
        border:4px solid #000;  
    }  
  
    #topBar {  
        height:60px;  
        display:flex;  
        align-items:center;  
        justify-content:center;  
        border-bottom:4px solid #000;  
        background:white;  
        font-size:24px;  
        font-weight:bold;  
        letter-spacing:1px;  
        position:relative;
    }  
  
    /* NEUE schöne Buttons */
    #backBtn,  
    #callBtn {  
        position:absolute;  
        top:11px;
        width:38px;  
        height:38px;  
        border:3px solid #000;  
        border-radius:8px;  
        background:white;  
        cursor:pointer;  
        display:flex;  
        align-items:center;  
        justify-content:center;  
        font-size:22px;  
        font-weight:bold;  
        line-height:1;  
        transition:0.1s;  
    }  

    #backBtn:hover,
    #callBtn:hover {
        background:#eee;
        transform:scale(1.05);
    }

    #backBtn {  
        left:10px;  
    }  

    #callBtn {
        right:10px;
    }
  
    #messages {  
        flex:1;  
        overflow-y:auto;  
        padding:10px;  
        background:white;  
    }  
  
    .msg {  
        background:white;  
        border:3px solid #000;  
        padding:10px;  
        margin:15px 0;  
        display:flex;  
        gap:10px;  
        cursor:pointer;  
        position:relative;  
        transform-origin:top left;  
        border-radius:6px;  
    }  
  
    .msg.highlight {  
        background:#dff1ff;  
    }  
  
    .avatar {  
        width:50px; height:50px;  
        border:3px solid #000;  
        background:white;  
        border-radius:6px;  
    }  
  
    #bottomBar {  
        height:70px;  
        display:flex;  
        align-items:center;  
        padding:10px;  
        border-top:4px solid #000;  
        background:white;  
    }  
  
    #input {  
        flex:1;  
        height:45px;  
        border:3px solid #000;  
        padding:10px;  
        background:white;  
    }  
  
    /* schönerer Send-Button */
    #sendBtn {  
        width:48px;  
        height:48px;  
        border:3px solid #000;  
        background:white;  
        margin-left:10px;  
        cursor:pointer;  
        border-radius:8px;  
        display:flex;  
        align-items:center;  
        justify-content:center;  
        font-size:26px;  
        font-weight:bold;  
        line-height:1;  
        transition:0.1s;
    }  

    #sendBtn:hover {
        background:#eee;
        transform:scale(1.05);
    }
  
</style>  
</head>  
<body>  
<div id="app">  
  
    <div id="topBar">  
        <div id="backBtn" onclick="location.href='/chat'">ESC</div>  
        BroChatter  
        <div id="callBtn" onclick="location.href='/chat/call'">CALL</div>
    </div>  
  
    <div id="messages"></div>  
  
    <div id="bottomBar">  
        <input id="input" placeholder="Nachricht...">  
        <div id="sendBtn">SEND</div>  
    </div>  
  
</div>  
  
<script>  
let selectedMsg = null;  
let messages = document.getElementById('messages');  
let input = document.getElementById('input');  
let sendBtn = document.getElementById('sendBtn');  
  
/*  
    MESSAGE CREATION  
    Speicher die Tiefe korrekt in data-depth
*/  
function createMessage(text, parent = null) {
    let depth = 0;

    if (parent) {
        depth = parseInt(parent.dataset.depth) + 1;
    }

    let scale = Math.pow(0.85, depth);

    let box = document.createElement('div');  
    box.className = 'msg';  
    box.dataset.depth = depth;
    box.style.transform = `translateX(${depth * 45}px) scale(${scale})`;  
  
    let avatar = document.createElement('div');  
    avatar.className = 'avatar';  
  
    let content = document.createElement('div');  
    content.innerHTML = `<strong>Bro:</strong><br>${text}`;  
  
    box.appendChild(avatar);  
    box.appendChild(content);  
  
    if (parent) {  
        parent.insertAdjacentElement('afterend', box);  
    } else {  
        messages.appendChild(box);  
    }  
  
    box.addEventListener('click', () => {  
        if (box.classList.contains('highlight')) {  
            box.classList.remove('highlight');  
            selectedMsg = null;  
            return;  
        }  
        document.querySelectorAll('.msg').forEach(m => m.classList.remove('highlight'));  
        box.classList.add('highlight');  
        selectedMsg = box;  
    });  
  
    messages.scrollTop = messages.scrollHeight;  
    return box;  
}  
  
sendBtn.addEventListener('click', () => {  
    let text = input.value.trim();  
    if (!text) return;  
  
    if (selectedMsg) {  
        createMessage(text, selectedMsg);  
        selectedMsg.classList.remove('highlight');  
        selectedMsg = null;  
    } else {  
        createMessage(text);  
    }  
  
    input.value = '';  
});  
</script>  
  
</body>  
</html>
